version: "3.8"

services:
  nginx:
    build:
      context: ../nginx
      dockerfile: Dockerfile
      args:
        - TEMPLATE=php-socket.conf.template
        - PORT=80
        - SERVER_NAME=localhost
        - ROOT=/var/www/
    container_name: nginx-dev
    environment:
      TEMPLATE: php-socket.conf.template
      PORT: 80
      SERVER_NAME: localhost
      ROOT: /var/www/
    ports:
      - "80:80"
    volumes:
      - phpsocket:/var/run/socket
      - ./website:/var/www:ro
    networks:
      - docker-test-net

  php8:
    build:
      context: ../php/8.0
      dockerfile: Dockerfile
      args:
        - OPCACHE_ENABLE=0
        - XDEBUG_MODE='debug,coverage,profile,trace'
    container_name: php8-dev
    environment:
      OPCACHE_ENABLE: 0
      XDEBUG_MODE: debug, coverage, profile, trace
    volumes:
      - phpsocket:/var/run/socket
      - ./website:/var/www:ro
    networks:
      - docker-test-net

networks:
  docker-test-net:

volumes:
  phpsocket:
